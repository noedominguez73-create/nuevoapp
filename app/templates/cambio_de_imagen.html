<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cambio de Imagen IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f0f2f5;
            min-height: 100vh;
            font-family: sans-serif;
        }

        /* Glassmorphism Utilities */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
    </style>
</head>

<body class="py-10 px-4">

    <main class="w-full max-w-6xl mx-auto space-y-8">

        <!-- Header -->
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
                <a href="/perfil-usuario"
                    class="bg-white p-3 rounded-full shadow-md hover:scale-105 transition-transform text-2xl">
                    ‚¨ÖÔ∏è
                </a>
                <div>
                    <h1 class="text-4xl font-bold text-slate-800">Cambio de Imagen IA</h1>
                    <p class="text-slate-500">Transforma tu estilo con Inteligencia Artificial</p>
                </div>
            </div>
            <div class="bg-blue-100 text-blue-700 px-4 py-2 rounded-full font-bold text-sm">
                ‚ú® Beta Preview
            </div>
        </div>

        <!-- Main Workspace -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <!-- Left Panel: Input (Original) -->
            <div class="bg-white rounded-[30px] p-6 shadow-xl flex flex-col h-full relative overflow-hidden group">
                <h2 class="text-xl font-bold text-slate-700 mb-4 flex items-center gap-2">
                    <span>üë§</span> Tu Foto Actual
                </h2>

                <!-- Upload Area -->
                <div id="uploadArea"
                    class="flex-1 border-4 border-dashed border-slate-200 rounded-2xl flex flex-col items-center justify-center cursor-pointer hover:bg-slate-50 hover:border-blue-400 transition-all relative overflow-hidden"
                    onclick="document.getElementById('fileInput').click()">

                    <!-- Placeholder Content -->
                    <div id="uploadPlaceholder" class="text-center p-8">
                        <span class="text-6xl mb-4 block opacity-50">üì§</span>
                        <p class="text-slate-500 font-medium">Sube una foto de cuerpo completo</p>
                        <p class="text-slate-400 text-sm mt-2">o arrastra aqu√≠</p>
                    </div>

                    <!-- Image Preview -->
                    <img id="originalPreview" class="hidden absolute inset-0 w-full h-full object-cover">

                    <!-- Change Photo Button (Visible on Hover when image exists) -->
                    <div id="changePhotoOverlay"
                        class="hidden absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                        <span class="bg-white text-slate-800 px-6 py-2 rounded-full font-bold shadow-lg">Cambiar
                            Foto</span>
                    </div>
                </div>

                <input type="file" id="fileInput" class="hidden" accept="image/*" onchange="handleImageUpload(event)">

                <!-- Quick Access Gallery -->
                <div class="mt-6 border-t border-slate-100 pt-4">
                    <h3 class="text-sm font-bold text-slate-500 mb-3 flex items-center justify-between">
                        <span>‚ö° Acceso R√°pido</span>
                        <span class="text-xs font-normal bg-slate-100 px-2 py-1 rounded-full">√öltimas 5</span>
                    </h3>
                    <div id="quickAccessGallery" class="grid grid-cols-5 gap-2">
                        <!-- Gallery items injected by JS -->
                    </div>
                </div>
            </div>

            <!-- Right Panel: Output (Transformation) -->
            <div class="bg-white rounded-[30px] p-6 shadow-xl flex flex-col h-full relative">
                <h2 class="text-xl font-bold text-slate-700 mb-4 flex items-center gap-2">
                    <span>‚ú®</span> Resultado IA
                </h2>

                <!-- Result Area -->
                <div id="resultArea"
                    class="flex-1 bg-slate-100 rounded-2xl flex items-center justify-center relative overflow-hidden">

                    <!-- Empty State -->
                    <div id="resultPlaceholder" class="text-center p-8 opacity-50">
                        <span class="text-6xl mb-4 block">üîÆ</span>
                        <p class="text-slate-500 font-medium">El resultado aparecer√° aqu√≠</p>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState"
                        class="hidden absolute inset-0 bg-white/90 flex flex-col items-center justify-center z-20">
                        <div class="animate-spin text-4xl mb-4">üåÄ</div>
                        <p class="text-blue-600 font-bold animate-pulse">Generando nuevo estilo...</p>
                    </div>

                    <!-- Result Image -->
                    <img id="resultImage" class="hidden absolute inset-0 w-full h-full object-cover z-10">
                </div>
            </div>

        </div>

        <!-- Controls Panel -->
        <div class="bg-white rounded-[30px] p-8 shadow-xl">

            <!-- Mode Selection -->
            <div class="flex items-center justify-center gap-6 mb-8 border-b border-slate-100 pb-8">
                <label class="flex items-center gap-3 cursor-pointer group">
                    <input type="radio" name="mode" value="style" checked onchange="toggleMode('style')"
                        class="w-6 h-6 text-blue-600 focus:ring-blue-500">
                    <span class="text-lg font-bold text-slate-700 group-hover:text-blue-600 transition-colors">üé® Look
                        Completo IA</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer group">
                    <input type="radio" name="mode" value="tryon" onchange="toggleMode('tryon')"
                        class="w-6 h-6 text-blue-600 focus:ring-blue-500">
                    <span class="text-lg font-bold text-slate-700 group-hover:text-blue-600 transition-colors">üõçÔ∏è
                        Probador Virtual</span>
                </label>
            </div>

            <!-- Section: Style Selection (Default) -->
            <div id="styleSection">
                <h3 class="text-xl font-bold text-slate-800 mb-6">Selecciona un Estilo</h3>

                <div id="styleSlotsContainer" class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                    <!-- Slots injected by JS -->
                </div>
            </div>

            <!-- Section: Virtual Try-On (Hidden by default) -->
            <div id="tryonSection" class="hidden">
                <h3 class="text-xl font-bold text-slate-800 mb-6">üõçÔ∏è Personaliza tu Look con el Closet IA</h3>

                <div id="inventorySelectors" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- Selectors injected by JS -->
                    <div
                        class="col-span-full text-center py-8 text-slate-400 bg-slate-50 rounded-2xl border border-dashed border-slate-200">
                        Cargando tu closet...
                    </div>
                </div>
            </div>

            <button id="btnGenerate" onclick="generateTransformation()"
                class="w-full bg-slate-800 text-white py-4 rounded-2xl font-bold text-xl shadow-lg hover:bg-slate-900 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3">
                <span>ü™Ñ</span> Generar Transformaci√≥n
            </button>
        </div>

    </main>

    <script src="/static/js/mirror-ia.js"></script>
</body>

</html>